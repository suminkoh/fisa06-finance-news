name: Bank News AI Analysis Pipeline

on:
  schedule:
    # í•œêµ­ ì‹œê°„ ê¸°ì¤€ ë§¤ì¼ ì˜¤ì „ 8ì‹œ (UTC 23:00)
    - cron: '0 23 * * *'
  workflow_dispatch: # ìˆ˜ë™ ì‹¤í–‰ ë²„íŠ¼ ìƒì„±

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4 # ìµœì‹  ë²„ì „ v4 ì‚¬ìš©

      - name: Set up Python 3.11
        uses: actions/setup-python@v4 # v4ê°€ ë” ì•ˆì •ì ì…ë‹ˆë‹¤
        with:
          python-version: "3.11"

      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          # ìš°ë¦¬ í”„ë¡œì íŠ¸ì— í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë“¤ ì„¤ì¹˜
          pip install requests beautifulsoup4 openai 
          if [ -f requirements.txt ]; then pip install -r requirements.txt; fi

      - name: Run fnews.py # ì‹¤í–‰ íŒŒì¼ëª…ì„ fnews.pyë¡œ ë³€ê²½
        run: |
          python fnews.py
        env:
          # Settings > Secrets > Actionsì— ì €ì¥í•œ ì´ë¦„ì„ ì—¬ê¸°ì— ì ìŠµë‹ˆë‹¤.
          OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}

      - name: Commit and Push changes
        run: |
          git config --global user.name "github-actions[bot]"
          git config --global user.email "github-actions[bot]@users.noreply.github.com"
          git add README.md
          # ë³€ê²½ì‚¬í•­ì´ ìˆì„ ë•Œë§Œ ì»¤ë°‹ (ì—†ìœ¼ë©´ í†µê³¼)
          git commit -m "ğŸš€ Update: Daily Bank News Report" || echo "No changes to commit"
          git push
